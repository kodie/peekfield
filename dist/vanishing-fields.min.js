/*!
  vanishing-fields v0.0.3 (https://github.com/kodie/vanishing-fields)
  by Kodie Grantham (https://kodieg.com)
*/
var vanishingFields=function(p,e){p=p||{},"string"==typeof(e=e||"[data-vanishing-field]:not(data-vanishing-field-ignore)")?e=document.querySelectorAll(e):e instanceof HTMLElement&&(e=[e]),void 0===vanishingFields.fieldCount?(vanishingFields.fieldCount=0,vanishingFields.lastTabIndex=-1):p.startingTabIndex||(p.startingTabIndex=vanishingFields.lastTabIndex+1);for(var c=0;c<e.length;c++)!function(l){var o=l.getAttribute("data-vanishing-field");if(o.length){vanishingFields.fieldCount++,l.label=document.querySelector('[data-vanishing-field-for="'+o+'"]'),l.inputs=l.querySelectorAll("input:not(data-vanishing-field-ignore),textarea:not(data-vanishing-field-ignore),select:not(data-vanishing-field-ignore)"),l.options=Object.assign({applyStyles:!0,closeOnFocusOut:!0,devMode:!1,display:null,onClose:null,onOpen:null,opened:!1,options:{},placeholder:null,startingTabIndex:0},p||{}),l.options.options[o]&&(l.options=Object.assign(l.options,l.options.options[o])),delete l.options.options;var e=l.getAttribute("data-vanishing-field-apply-styles");e&&(l.options.applyStyles="false"!==e);e=l.getAttribute("data-vanishing-field-close-on-focus-out");e&&(l.options.closeOnFocusOut="false"!==e),l.label&&(l.label.display=l.label.getAttribute("data-vanishing-field-display")||l.options.display,l.label.placeholder=l.label.getAttribute("data-vanishing-field-placeholder")||l.options.placeholder,!1===l.options.startingTabIndex||l.label.getAttribute("tabindex")||l.label.setAttribute("tabindex",l.options.startingTabIndex+c)),!1===l.options.startingTabIndex||l.getAttribute("tabindex")||(l.setAttribute("tabindex",l.options.startingTabIndex+c),vanishingFields.lastTabIndex=l.options.startingTabIndex+c),l.open=function(e){return l.options.devMode&&console.log(o,"open"),!0===l.opened||(l.opened=!0,l.options.applyStyles&&(l.style.display=null,l.style.visibility=null,l.label&&(l.label.style.display="none",l.label.style.visibility="hidden")),l.classList.toggle("open",l.opened),l.label&&l.label.classList.toggle("open",l.opened),(l.inputs.length?l.inputs[0]:l).focus(),!1!==e&&l.dispatchEvent(new Event("open",{bubbles:!0}))),l},l.close=function(e){if(l.options.devMode&&console.log(o,"close"),!1===l.opened)return l;l.opened=!1,l.values=l.getInputValues(),l.options.applyStyles&&(l.style.display="none",l.style.visibility="hidden",l.label&&(l.label.style.display=null,l.label.style.visibility=null));var n,t=Object.values(l.values).filter(function(e){return e&&e.length});for(n in l.changed=!1,l.empty=!t.length,l.values)if(l.values.hasOwnProperty(n))if(Array.isArray(l.values[n])){if(l.values[n].sort().join(",")!==l.originalValues[n].sort().join(",")){l.changed=!0;break}}else if(l.values[n]!==l.originalValues[n]){l.changed=!0;break}return l.classList.toggle("open",l.opened),l.classList.toggle("changed",l.changed),l.classList.toggle("empty",l.empty),l.label&&(l.label.classList.toggle("open",l.opened),l.label.classList.toggle("changed",l.changed),l.label.classList.toggle("empty",l.empty),l.empty?l.label.placeholder?"function"==typeof l.label.placeholder?l.label.innerHTML=l.label.placeholder(l):l.label.innerHTML=l.label.placeholder:l.label.innerHTML="":l.label.display?"function"==typeof l.label.display?l.label.innerHTML=l.label.display(l):l.label.innerHTML=l.label.display.replace(/{(.+?)}/g,function(e,n){n=n.split("|"),e=l.values[n[0]]||n[1]||e;return e=Array.isArray(e)?e.join(n[2]||","):e}):l.label.innerHTML=t.join(" ")),!1!==e&&l.dispatchEvent(new Event("close",{bubbles:!0})),l},l.toggle=function(e,n){return l.options.devMode&&console.log(o,"toggle"),!0===e||void 0===e&&!l.opened?l.open(n):(!1===e||void 0===e&&l.opened)&&l.close(n),l},l.getInputValues=function(){var e={};return l.inputs.length&&(e=Array.from(l.inputs).reduce(function(e,n){var t=n.name||n.id,l=n.value,o=n.tagName.toLowerCase();if("[]"===t.slice(-2)&&(t=t.substr(0,t.length-2),l=[l]),"select"===o&&n.multiple&&(l=Array.from(n.selectedOptions).map(function(e){return e.value})),"file"===n.type&&(l=Array.from(n.files).map(function(e){return e.name})),("checkbox"===n.type||"radio"===n.type)&&!n.checked){if(e[t])return e;l=Array.isArray(l)?[]:null}return e[t]&&(l=(l=Array.isArray(e[t])?e[t].concat([l]):[e[t],l]).filter(function(e){return e&&e.length})),e[t]=l,e},{})),l.options.devMode&&console.log(o,"input values:",e),e},l.label&&(l.label.addEventListener("click",function(e){e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"label click"),l.open()}),l.label.addEventListener("focusin",function(e){e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"label focusin"),l.open()})),l.addEventListener("focusout",function(e){l.contains(e.relatedTarget)||l.contains(document.activeElement)||(e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"focusout"),l.options.closeOnFocusOut&&l.close())}),l.options.onOpen&&l.addEventListener("open",function(e){e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"onOpen"),l.options.onOpen(e,l)}),l.options.onClose&&l.addEventListener("close",function(e){e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"onClose"),l.options.onClose(e,l)});for(var n=document.querySelectorAll('[data-vanishing-field-open="'+o+'"]'),t=0;t<n.length;t++)!function(n){n.addEventListener("click",function(e){e.target===e.currentTarget&&(e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"openElement click",n),l.open())})}(n[t]);for(var i=document.querySelectorAll('[data-vanishing-field-close="'+o+'"]'),a=0;a<i.length;a++)!function(n){n.addEventListener("click",function(e){e.target===e.currentTarget&&(e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"closeElement click",n),l.close())})}(i[a]);for(var s=document.querySelectorAll('[data-vanishing-field-toggle="'+o+'"]'),r=0;r<s.length;r++)!function(n){n.addEventListener("click",function(e){e.target===e.currentTarget&&(e.stopImmediatePropagation(),l.options.devMode&&console.log(o,"toggleElement click",n),l.toggle())})}(s[r]);for(var d=0;d<l.inputs.length;d++)!function(t){if(t.id)for(var e=document.querySelectorAll("label[for="+t.id+"]"),n=0;n<e.length;n++)!function(n){n.addEventListener("click",function(e){l.options.devMode&&console.log(o,"input label click",n,t),l.open()})}(e[n])}(l.inputs[d]);l.values=l.getInputValues(),l.originalValues=Object.assign({},l.values);e=Object.values(l.values).filter(function(e){return e&&e.length});l.changed=!1,l.empty=!e.length,l.classList.toggle("empty",l.empty),l.label&&l.label.classList.toggle("empty",l.empty),l.classList.contains("open")||l.options.opened?l.open(!1):l.close(!1)}else console.warn(l,"data-vanishing-field attribute needs to be set to a string")}(e[c]);return e};
//# sourceMappingURL=vanishing-fields.min.js.map